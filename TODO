- implement OpenMP parallelization

- fix error in calculating H (first moment) at the surface
